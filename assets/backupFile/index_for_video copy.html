<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Sports Carousel Mockup - 3 Horizontal Vertical Continuous Scroll with Flags</title>
  <link href="https://fonts.googleapis.com/css2?family=Caveat+Brush:wght@400&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      display: flex;
      flex-direction: column;
      justify-content: space-around;
      align-items: center;
      min-height: 100vh;
      overflow-x: auto;
      gap: 20px;
      position: relative;
    }
    .pinatas-fire {
      font-family: 'Caveat Brush', cursive;
      font-size: 5rem;
      color: #fdbd4a;
      transform: skewX(-6deg);
      text-shadow: 9px 7px 0 #ff0e00a1, 12px 10px 2px rgba(255, 140, 0, 0.6), 1px 1px 2px rgba(255, 255, 255, 0.5), 0 0 5px #ff4500;
      filter: contrast(1.4) drop-shadow(4px 6px 12px rgba(0, 0, 0, 0.3));
      animation: fire-trail 4s ease forwards;
      overflow: hidden;
      border-right: 3px solid #ff4500;
      white-space: nowrap;
      text-align: center;
      margin: 1rem 0rem 0rem 0rem;
    }
    #Departure-city {
      margin: 0.5rem 0rem 1.5rem 0rem;
      text-align: center; /* Added: Center the entire block */
    }
    #Departure-city p {
      margin: 0;
      font-size: 2rem;
      color: #fff;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
      background-color: rgb(239 198 124 / 87%);
      padding: 0.25rem 2.75rem;
      border-radius: 2rem;
    }
    #Departure-city p:nth-child(1) {
      margin: 0;
      font-size: 1.25rem;
      color: #fff;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
      text-align: center;
      margin-bottom: 0.5rem;
      width: auto; /* Already auto, but background is on the p */
      margin-left: 0; /* Removed: No left margin to allow full centering */
      display: inline-block; /* Added: Makes background hug text width */
      width: fit-content; /* Added: Adapts width to content length */
      padding: 0.25rem 1rem; /* Adjusted: Smaller padding for shorter text like "From" */
    }

    .month{
        margin-bottom: 2rem;
        font-size: 2rem;
        color: #fff;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
        background-color: rgb(239 198 124 / 87%);
        padding: .70rem 2.75rem;
        border-radius: 2rem;
        text-align: center;
    
    }
    @keyframes fire-trail {
      0% { opacity: 0; filter: blur(2px); width: 0; }
      100% { opacity: 1; width: 100%; filter: blur(0); }
    }
    .parent-container {
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: center;
      width: 100%;
      gap: 30px;
      padding-bottom: 20px;
    }
    .carousel-container {
      position: relative;
      width: 18vw;
      height: 64vh;
      background: linear-gradient(135deg, rgba(68, 32, 40, .397) 0%, rgba(254, 214, 227, 0) 100%);
      border-radius: 25px;
      overflow: hidden;
      box-shadow: 0 25px 50px rgba(6, 6, 6, .032);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      animation: float 3s ease-in-out infinite;
      padding: 0 2%;
      box-shadow: -14px -14px 7px #0000009e;
    }
    .carousel-container::after {
      content: '';
      position: absolute;
      bottom: -15px;
      left: 50%;
      transform: translateX(-50%);
      width: 130%;
      height: 30px;
      background: radial-gradient(ellipse at center, rgba(0, 0, 0, .25) 0%, rgba(0, 0, 0, .1) 30%, transparent 70%);
      border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
      z-index: -1;
      filter: blur(8px);
    }
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    .carousel-wrapper {
      display: flex;
      flex-direction: column;
      width: 85%;
      height: 100%;
      position: relative;
      padding: 0 5%;
      transition: transform .3s ease;
      gap: 9.5%;
      cursor: grab; 
      user-select: none;
      will-change: transform;
      padding-bottom: 100%; 
    }
    .carousel-wrapper:active {
      cursor: grabbing;
    }

    .month-title {
        text-align: center;
        font-size: 1.5rem;
        font-weight: bold;
        color: #fdbd4a;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        background-color: rgba(0,0,0,0.1);
        padding: 5px;
        border-radius: 5px;
    }

    /* PATCH : permet d'afficher la dernière card-slot entièrement */
    


    @keyframes scrollHorizontal {
      0% { transform: translateX(0); }
      100% { transform: translateX(-28.5%); }
    }


   @keyframes scrollVertical {
    0% { 
        transform: translateY(0); 
    }
    100% { 
        transform: translateY(-100%); /* Full scroll through all content */
    }
}

  .carousel-wrapper.animating {
      animation: scrollVertical 27s linear infinite paused; /* Paused par défaut */
  }

  .carousel-wrapper.start-scroll {
      animation-play-state: running; /* Démarre le scroll quand cette classe est ajoutée */
  }


/* Ensure content is duplicated for infinite scroll */
.carousel-wrapper {
  display: flex;
  flex-direction: column;
}

.carousel-wrapper::after {
  content: "";
  display: block;
  height: 100%; /* Full height duplicate */
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
}


    .carousel-card {
      width: 100%;
      height: 100%;
      margin: 0;
      border-radius: 5px;
      overflow: hidden;
      box-shadow: 0 15px 35px rgba(0 0, 0, .2);
      transition: all .4s ease;
      position: relative;
      opacity: 1;
      transform: scale(1);
      flex-shrink: 0;
    }
    .carousel-card img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      opacity: .88;
      position: relative;
      z-index: 1;
    }
    .overlay-img {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 50%;
      height: auto;
      opacity: .7;
      z-index: 2;
    }
    .card-slot {
    position: relative;
    height: 11.5vh;
    flex-shrink: 0;
    margin-bottom: 20px; /* Ajoute de l'espace supplémentaire */
}
    .carousel-wrapper .card-slot:first-child {
      margin-top: 0 !important;
      padding-top: 0 !important;
    }
    .card-slot .carousel-card {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 85%;
      border-radius: 8px;
    }
    .card-slot .container-city-text {
    position: absolute;
    z-index: 6;
    bottom: -38px;
    flex: auto;
    justify-content: center;
    width: 100%;
    display: flex;
    line-break: auto;
    padding: .5em 0;
    background-color: #efc77c;
    border-radius: 0 0 20px 20px;
    box-shadow: 1px 0 13px 0 black;
    height: 2.45rem;
    display: inline-block;
}
.date {
    margin: 0;
    text-align: center;
    color: #000;
    font-weight: 580;
    font-size: 0.90rem;
    padding-top: 0.25rem;
    background: #d087007d;
    padding: 3px 0px;
}
    .city-destination {
      margin: 4px;
      text-align: center;
      color: #000;
      font-weight: 700;
      font-size: 1rem;
    }
    .etiquet-price {
      position: absolute;
      top: 12px;
      left: -.85rem;
      background: rgb(239 198 124 / 90%);
      width: 4rem;
      margin-right: -.65rem;
      padding: .2rem 1.2rem;
      border-radius: 0 5px 5px 0;
      z-index: 6;
      box-sizing: border-box;
      display: inline-flex;
      align-items: center;
      
    }
    .etiquet-price p {
      margin: 0;
      padding-top: .4rem;
      display: flex;
      font-size: 1.3rem;
      font-weight: 600;
      color: #000446;
    }
    .etiquet-price p:after {
      content: "€";
      margin-left: 3px;
      font-size: 16px;
      font-weight: 600;
      color: #000;
    }
    .etiquet-price div {
      position: absolute;
      bottom: -23px;
      left: 0;
      width: 0;
      height: 0;
      border-top: 13px solid #c58102;
      border-bottom: 10px solid transparent;
      border-left: 13px solid transparent;
      z-index: -6;
    }
    .carousel-wrapper:hover {
      animation-play-state: paused;
    }
    @media (max-width: 768px) {
      body {
        align-items: center;
        overflow-y: auto;
        overflow-x: hidden;
        padding: 10px;
      }
    
      .pinatas-fire { font-size: 5rem; margin: 1rem 0rem 1rem 0rem; } /* Ajust pour landscape */
      #Departure-city{
          font-size: 3rem;
          margin: 0.5rem 0rem 2rem 0rem;
      }
      .parent-container {
        flex-direction: row;
        justify-content: center;
        gap: 30px;
        width: 100%;
      }
      .carousel-container {
        width: 35vw;
        height: 60vh;
        max-width: 200px;
      }
      .parent-container > .carousel-container:nth-child(3) {
        display: none;
      }

      .carousel-wrapper {
        gap: 6.5%;
      }
      .carousel-container::after {
        width: 110%;
        bottom: -10px;
        height: 20px;
      }
      .card-slot { height: 25%; }
      .card-slot .carousel-card { height: 86%; }
      .etiquet-price { width: 14vw; }
    }
    @media (max-width: 430px) {
      .parent-container { gap: 10px; }
      .carousel-container {
        width: 40vw;
        max-width: 180px;
      }
      .card-slot { height: 25%; }
      .etiquet-price { top: 10px; width: 5.5rem; right: -.45rem; }
      .pinatas-fire { font-size: clamp(2.5rem, 10vw, 4rem); }
    }

    @media only screen and (width: 1080px) and (height: 1920px) {
  .card-slot .carousel-card {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 63%;
    border-radius: 8px;
  }

  .card-slot .container-city-text {
    position: absolute;
    z-index: 6;
    bottom: 39px;
    flex: auto;
    justify-content: center;
    width: 100%;
    display: flex;
    line-break: auto;
    padding: 0.5em 0;
    background-color: #efc77c;
    border-radius: 0 0 20px 20px;
    box-shadow: 1px 0 13px 0 black;
    height: 2.45rem;
    display: inline-block;
  }

  .carousel-wrapper {
    display: flex;
    flex-direction: column;
    width: 85%;
    height: 100%;
    position: relative;
    padding: 0 5%;
    transition: transform .3s ease;
    gap: 0%;
    cursor: grab;
    user-select: none;
    will-change: transform;
    padding-bottom: 100%;
    
  }

  .carousel-wrapper {
    padding-top: 11vh !important;   /* au lieu de 0 ou de valeurs en % */
  }
  .carousel-wrapper .card-slot:first-child {
    margin-top: 1vh !important;    /* compense exactement le padding-top ajouté */
  }

  .pinatas-fire {
    font-family: 'Caveat Brush', cursive;
    font-size: 10rem;
    color: #fdbd4a;
    transform: skewX(-6deg);
    text-shadow: 9px 7px 0 #ff0e00a1, 12px 10px 2px rgb(255 140 0 / 60%), 1px 1px 2px rgb(255 255 255 / 50%), 0 0 5px #ff4500;
    filter: contrast(1.4) drop-shadow(4px 6px 12px rgba(0, 0, 0, 0.3));
    animation: fire-trail 4s ease forwards;
    overflow: hidden;
    border-right: 3px solid #ff4500;
    white-space: nowrap;
    text-align: center;
    margin: -6rem 0rem 2rem 0rem;
  }

  #Departure-city p:nth-child(1) {
    margin: 0;
    font-size: 2rem;
    color: #fff;
    text-shadow: 2px 2px 4px rgb(0 0 0 / 70%);
    text-align: center;
    margin-bottom: 0.8rem;
    width: auto;
    margin-left: 0;
    display: inline-block;
    width: fit-content;
    padding: 0.25rem 3rem;
  }

  #Departure-city p {
    margin: 0;
    font-size: 3rem;
    color: #fff;
    text-shadow: 2px 2px 4px rgb(0 0 0 / 70%);
    background-color: rgb(239 198 124 / 87%);
    padding: 0.25rem 6.75rem;
    border-radius: 3rem;
  }
  .card-slot .container-city-text {
    bottom: 26px;
    height: 3.2rem;
  }
  .date {
    font-size: 1.2rem;
  }
  .city-destination {
    font-size: 1.4rem;
  }

    .etiquet-price {
    height: 3rem;
    width: 4.5rem;
    
  }
}


    @media (orientation: landscape) and (max-height: 500px) {
      #logo { font-size: clamp(3rem, 8vw, 5rem); }
      body {
        align-items: center;
        padding: 10px;
        overflow-x: hidden;
        overflow-y: auto;
      }
      .parent-container {
        display: block;
        width: 80%;
      }
      .carousel-container:nth-child(1),
      .carousel-container:nth-child(2) {
        height: 25vh;
        width: 70vw;
        margin-bottom: 10px;
      }
      .carousel-container:nth-child(3) { display: none; }
      .carousel-container {
        background: linear-gradient(135deg, rgba(68, 32, 40, .397) 0%, rgba(254, 214, 227, 0) 100%);
        border-radius: 25px;
        overflow: hidden;
        box-shadow: 0 25px 50px rgba(6, 6, 6, .032);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        animation: float 3s ease-in-out infinite;
        padding: 0 2%;
      }
      .carousel-wrapper {
        flex-direction: row;
        width: 100%;
        height: 100%;
        padding: 0 5%;
        gap: 1.5%;
        cursor: grab;
        user-select: none;
        will-change: transform;
        transition: transform .3s ease;
      }
      .carousel-wrapper.animating {
        animation: scrollHorizontal 7s linear infinite;
      }
      .carousel-wrapper:active { cursor: grabbing; }
      .carousel-wrapper:hover { animation-play-state: paused; }
      .card-slot {
        width: 25%;
        height: 100%;
        flex-shrink: 0;
        position: relative;
      }
      .card-slot .carousel-card {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 15px 35px rgba(0, 0, 0, .2);
        transition: all .4s ease;
        opacity: 1;
        transform: scale(1);
        flex-shrink: 0;
      }
      .card-slot .carousel-card img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
        opacity: .88;
        position: relative;
        z-index: 1;
      }
      .overlay-img {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50%;
        height: auto;
        opacity: .7;
        z-index: 2;
      }
      .container-city-text {
        position: absolute;
        z-index: 6;
        bottom: 0;
        left: 0;
        width: 100%;
        height: auto;
        padding: .5em 0;
        background-color: #e357297a;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      .city-destination {
        margin: 0;
        text-align: center;
        color: #fff;
        font-weight: 700;
        font-size: .8rem;
      }
      .etiquet-price {
        position: absolute;
        top: 12px;
        left: -0.85rem;
        background: #fdbd4a;
        width: auto;
        margin-right: -.65rem;
        padding: .2rem 1.2rem;
        border-radius: 0 5px 5px 0;
        z-index: 6;
        box-sizing: border-box;
        display: inline-flex;
        align-items: center;
      }
      .etiquet-price p {
        margin: 0;
        padding-top: .4rem;
        display: flex;
        font-size: 1.3rem;
        font-weight: 600;
        color: #000446;
      }
      .etiquet-price p:after {
        content: "/match";
        margin-left: 5px;
        font-size: 12px;
        font-weight: 300;
        color: #4d4d4d;
      }
      .etiquet-price div {
        position: absolute;
        bottom: -23px;
        left: 0;
        width: 0;
        height: 0;
        border-top: 13px solid #c58102;
        border-bottom: 10px solid transparent;
        border-left: 13px solid transparent;
        z-index: -6;
      }
      .carousel-container::after {
        content: '';
        position: absolute;
        bottom: -15px;
        left: 50%;
        transform: translateX(-50%);
        width: 130%;
        height: 30px;
        background: radial-gradient(ellipse at center, rgba(0, 0, 0, .25) 0%, rgba(0, 0, 0, .1) 30%, transparent 70%);
        border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
        z-index: -1;
        filter: blur(8px);
      }
      .pinatas-fire { font-size: 5rem; margin: 0rem ; } /* Ajust pour landscape */
      #Departure-city{
          font-size: 2rem;
          margin: 0rem; 
      }
    }
    #bg-image {
      position: fixed;
      top: 50%;
      left: 50%;
      min-width: 100%;
      min-height: 100%;
      width: auto;
      height: auto;
      z-index: -1;
      transform: translate(-50%, -50%);
      object-fit: cover; 
    }
    .video-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.3);
      z-index: 0;
    }
    .content {
      position: relative;
      z-index: 1;
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
    }
  </style>
</head>
<body>
  <img src="./assets/img/pexels-muhammad-akbar-putra-2151015639-31487389.jpg" id="bg-image" alt="Background Image"> <!-- Changed: Video to static image; update src to your picture path -->
  <div class="video-overlay"></div>
  <div class="content">
    <div id="logo"><h1 class="pinatas-fire">WingsToVibes</h1></div>
    <div id="Departure-city">
    <p>From</p>
    <p id="city-name">Paris</p>
  </div>

  <div class="parent-container" id="carousels-container">
    
    <!-- ====================== MOCKUP STATIQUE (toujours là ====================== -->
     <div>
      <div class="month">December</div>
      <div class="carousel-container">
      <div class="carousel-wrapper animating">
        <!-- 8 cartes dupliquées pour boucle infinie -->
        <div class="card-slot">
          <div class="carousel-card">
            <img src="https://flagcdn.com/w320/it.jpg" alt="Italy">
            <img class="overlay-img" src="https://source.unsplash.com/random/300x300/?rome" alt="">
          </div>
          <div class="container-city-text">
            <p class="date">15 Jan</p>
            <p class="city-destination">Rome</p>
          </div>
          <div class="etiquet-price">
            <p>89</p>
            <div></div>
          </div>
        </div>
        
        <!-- ... répète 7 fois avec d'autres villes ... -->
        <!-- (je ne remets pas les 50 lignes pour ne pas alourdir, mais elles sont là dans ton fichier original) -->
      </div>
    </div>
  </div>
    

    <div>
      <div class="month">December</div>
      <div class="carousel-container">
      <div class="carousel-wrapper animating">
        <!-- 8 cartes dupliquées pour boucle infinie -->
        <div class="card-slot">
          <div class="carousel-card">
            <img src="https://flagcdn.com/w320/it.jpg" alt="Italy">
            <img class="overlay-img" src="https://source.unsplash.com/random/300x300/?rome" alt="">
          </div>
          <div class="container-city-text">
            <p class="date">15 Jan</p>
            <p class="city-destination">Rome</p>
          </div>
          <div class="etiquet-price">
            <p>89</p>
            <div></div>
          </div>
        </div>
        <!-- ... répète 7 fois avec d'autres villes ... -->
        <!-- (je ne remets pas les 50 lignes pour ne pas alourdir, mais elles sont là dans ton fichier original) -->
      </div>
    </div>
  </div>

    <div>
      <div class="month">December</div>
      <div class="carousel-container">
      <div class="carousel-wrapper animating">
        <!-- 8 cartes dupliquées pour boucle infinie -->
        <div class="card-slot">
          <div class="carousel-card">
            <img src="https://flagcdn.com/w320/it.jpg" alt="Italy">
            <img class="overlay-img" src="https://source.unsplash.com/random/300x300/?rome" alt="">
          </div>
          <div class="container-city-text">
            <p class="date">15 Jan</p>
            <p class="city-destination">Rome</p>
          </div>
          <div class="etiquet-price">
            <p>89</p>
            <div></div>
          </div>
        </div>
        <!-- ... répète 7 fois avec d'autres villes ... -->
        <!-- (je ne remets pas les 50 lignes pour ne pas alourdir, mais elles sont là dans ton fichier original) -->
      </div>
    </div>
  </div>

  <!-- ====================== SCRIPT DYNAMIQUE (ne touche pas au statique) ====================== -->

  <script>
  const urlParams = new URLSearchParams(window.location.search);
  const city = urlParams.get('city');

  if (city) {
    document.getElementById('city-name').textContent = city;

    fetch(`/data?city=${encodeURIComponent(city)}`)
      .then(r => r.json())
      .then(data => {
        const container = document.getElementById('carousels-container');
        container.innerHTML = '';

        if (!data.months || Object.keys(data.months).length === 0) {
          document.getElementById('city-name').textContent = city + ' → Aucune offre';
          window.__carouselReady = true;
          return;
        }

        const sortedMonths = Object.keys(data.months).sort();
        const monthsToShow = sortedMonths.slice(0, 3).filter(m => data.months[m]?.length > 0);

        const monthNames = {
          "01": "Janvier", "02": "Février", "03": "Mars", "04": "Avril", 
          "05": "Mai", "06": "Juin", "07": "Juillet", "08": "Août", 
          "09": "Septembre", "10": "Octobre", "11": "Novembre", "12": "Décembre"
        };

        monthsToShow.forEach((monthKey, i) => {
    let offers = (data.months[monthKey] || []).slice(0, 8);
    if (offers.length === 0) return;

    const monthNames = {
        "01": "Janvier", "02": "Février", "03": "Mars", "04": "Avril", 
        "05": "Mai", "06": "Juin", "07": "Juillet", "08": "Août", 
        "09": "Septembre", "10": "Octobre", "11": "Novembre", "12": "Décembre"
    };
    const monthLabel = monthNames[monthKey.split('-')[1]];

    const monthWrapper = document.createElement('div');
    
    const monthElement = document.createElement('div');
    monthElement.className = 'month';
    monthElement.textContent = monthLabel;

    const carouselContainer = document.createElement('div');
    carouselContainer.className = 'carousel-container';

    const carouselWrapper = document.createElement('div');
    carouselWrapper.className = 'carousel-wrapper animating';
    
    // Génération des cartes
    carouselWrapper.innerHTML = `
        ${generateCards(offers)}
        ${generateCards(offers)} <!-- duplication pour boucle infinie -->
    `;

    // Assembler la structure
    carouselContainer.appendChild(carouselWrapper);
    monthWrapper.appendChild(monthElement);
    monthWrapper.appendChild(carouselContainer);
    
    container.appendChild(monthWrapper);
});

// Ajouter un événement global pour démarrer le scroll après 2 secondes
window.addEventListener('load', () => {
    setTimeout(() => {
        document.querySelectorAll('.carousel-wrapper').forEach((wrapper, index) => {
            // Ajoute un délai supplémentaire entre chaque carrousel
            setTimeout(() => {
                wrapper.classList.add('start-scroll');
            }, index * 500); // 500ms entre chaque carrousel
        });
    }, 2000); // 2 secondes avant de commencer
});

// Ajouter du CSS pour le nouveau style de mois
const styleElement = document.createElement('style');
styleElement.textContent = `
.month {
    margin-bottom: 2rem;
    font-size: 2rem;
    color: #fff;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
    background-color: rgb(239 198 124 / 87%);
    padding: .70rem 2.75rem;
    border-radius: 2rem;
    text-align: center;
    width: fit-content;
    margin-left: auto;
    margin-right: auto;
}
`;
document.head.appendChild(styleElement);

        // Complète avec carrousels vides si besoin
        while (container.children.length < 3) {
          const emptyCarousel = document.createElement('div');
          emptyCarousel.className = 'carousel-container';
          emptyCarousel.innerHTML = `
            <div class="month-title">Aucune offre</div>
            <div class="carousel-wrapper animating"></div>
          `;
          container.appendChild(emptyCarousel);
        }

        // Prêt ultra-rapide
        setTimeout(() => window.__carouselReady = true, 400);
      })
      .catch(() => setTimeout(() => window.__carouselReady = true, 400));
  } else {
    window.__carouselReady = true;
  }

  // Fonction magique : date complète + ville tronquée proprement
  function generateCards(offers) {
    return offers.map(o => {
      // Format date : "Nov 22 - Nov 29" → "22 - 29 nov"
      let dateStr = 'Bientôt';
      if (o.date && o.date.includes(' - ')) {
        const parts = o.date.split(' - ');
        const start = parts[0].match(/\d+/);
        const end   = parts[1].match(/\d+/);
        const month  = parts[0].match(/[A-Za-z]+/);
        if (start && end && month) {
          dateStr = `${start[0]} - ${end[0]} ${month[0].toLowerCase().slice(0,3)}`;
        }
      }

      // Ville longue → "Palma de Mallorca" devient "Palma..."
      let cityName = (o.cityDest || 'Ville').trim();
      if (cityName.length > 14) {
        cityName = cityName.split(' ')[0] + '...'; // garde seulement le 1er mot + ...
      }

      return `
        <div class="card-slot">
          <div class="carousel-card">
            <img src="assets/flags/${(o.destCountryCode || 'xx').toLowerCase()}.png"
                 onerror="this.style.opacity='0'"
                 style="width:100%;height:100%;object-fit:cover;">
            <img class="overlay-img" 
                 src="assets/cities/${cityName.toLowerCase().replace(/[^a-z]/g,'-')}.jpg"
                 onerror="this.style.opacity='0'">
          </div>
          <div class="container-city-text">
            <p class="date">${dateStr}</p>
            <p class="city-destination">${cityName}</p>
          </div>
          <div class="etiquet-price">
            <p>${o.priceFrom || '??'}</p>
            <div></div>
          </div>
        </div>
      `;
    }).join('');
  }

  window.addEventListener('load', () => {
    setTimeout(() => {
        document.querySelectorAll('.carousel-wrapper').forEach((wrapper, index) => {
            // Ajoute un délai supplémentaire entre chaque carrousel
            setTimeout(() => {
                wrapper.classList.add('start-scroll');
            }, index * 500); // 500ms entre chaque carrousel
        });
    }, 2000); // 2 secondes avant de commencer
});
</script>

</body>
</html>